warning: No `requires-python` value found in the workspace. Defaulting to `>=3.13`.
ERROR:2026-01-21 02:33:17,234:jax._src.xla_bridge:477: Jax plugin configuration error: Exception when calling jax_plugins.xla_cuda12.initialize()
Traceback (most recent call last):
  File "/home/mhough/src/dmipy/.venv/lib/python3.13/site-packages/jax/_src/xla_bridge.py", line 475, in discover_pjrt_plugins
    plugin_module.initialize()
    ~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/mhough/src/dmipy/.venv/lib/python3.13/site-packages/jax_plugins/xla_cuda12/__init__.py", line 328, in initialize
    _check_cuda_versions(raise_on_first_error=True)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mhough/src/dmipy/.venv/lib/python3.13/site-packages/jax_plugins/xla_cuda12/__init__.py", line 285, in _check_cuda_versions
    local_device_count = cuda_versions.cuda_device_count()
RuntimeError: jaxlib/cuda/versions_helpers.cc:113: operation cuInit(0) failed: Unknown CUDA error 303; cuGetErrorName failed. This probably means that JAX was unable to load the CUDA libraries.
/home/mhough/src/dmipy/dmipy_jax/examples/sbi/train_noddi.py:24: UserWarning: A JAX array is being set as static! This can result in unexpected behavior and is usually a mistake to do.
  watson = SD1Watson(grid_size=200)
/home/mhough/src/dmipy/dmipy_jax/examples/sbi/train_noddi.py:44: UserWarning: A JAX array is being set as static! This can result in unexpected behavior and is usually a mistake to do.
  watson2 = SD1Watson(grid_size=200) # Need separate instance or same? Same class is fine.
Initializing NODDI SBI Training...
Starting Loop...
  0%|          | 0/3000 [00:00<?, ?it/s]  0%|          | 0/3000 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/home/mhough/src/dmipy/dmipy_jax/examples/sbi/train_noddi.py", line 403, in <module>
    main()
    ~~~~^^
  File "/home/mhough/src/dmipy/dmipy_jax/examples/sbi/train_noddi.py", line 337, in main
    x, y = get_batch(k_batch, BATCH_SIZE)
           ~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/home/mhough/src/dmipy/dmipy_jax/examples/sbi/train_noddi.py", line 130, in get_batch
    f_intra_raw = jax.random.beta(k_fintra, 5.0, 5.0, shape=(batch_size,))
  File "/home/mhough/src/dmipy/.venv/lib/python3.13/site-packages/jax/_src/random.py", line 1133, in beta
    shape = core.canonicalize_shape(shape)
TypeError: Shapes must be 1D sequences of concrete values of integer type, got (JitTracer<~int32[]>,).
If using `jit`, try using `static_argnums` or applying `jit` to smaller subfunctions.
The error occurred while tracing the function get_batch at /home/mhough/src/dmipy/dmipy_jax/examples/sbi/train_noddi.py:117 for jit. This concrete value was not available in Python because it depends on the value of the argument batch_size.
--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
