warning: No `requires-python` value found in the workspace. Defaulting to `>=3.12`.
/home/mhough/src/dmipy/examples/demo_pypulseq_bigmac.py:30: UserWarning: Specified RF delay 0.00 us is less than the dead time 100 us. Delay was increased to the dead time.
  rf90 = pp.make_sinc_pulse(flip_angle=90 * np.pi/180, duration=2e-3, system=system,
/home/mhough/src/dmipy/examples/demo_pypulseq_bigmac.py:32: UserWarning: Specified RF delay 0.00 us is less than the dead time 100 us. Delay was increased to the dead time.
  rf180 = pp.make_block_pulse(flip_angle=180 * np.pi/180, duration=2e-3, system=system)
ERROR:2026-01-18 18:50:26,379:jax._src.callback:94: jax.pure_callback failed
Traceback (most recent call last):
  File "/home/mhough/src/dmipy/.venv/lib/python3.12/site-packages/jax/_src/callback.py", line 92, in pure_callback_impl
    return tree_util.tree_map(np.asarray, callback(*args))
                                          ^^^^^^^^^^^^^^^
  File "/home/mhough/src/dmipy/.venv/lib/python3.12/site-packages/jax/_src/callback.py", line 70, in __call__
    return tree_util.tree_leaves(self.callback_func(*args, **kwargs))
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mhough/src/dmipy/.venv/lib/python3.12/site-packages/equinox/_errors.py", line 88, in raises
    raise _EquinoxRuntimeError(
equinox._errors._EquinoxRuntimeError: The maximum number of solver steps was reached. Try increasing `max_steps`.


--------------------
An error occurred during the runtime of your JAX program! Unfortunately you do not appear to be using `equinox.filter_jit` (perhaps you are using `jax.jit` instead?) and so further information about the error cannot be displayed. (Probably you are seeing a very large but uninformative error message right now.) Please wrap your program with `equinox.filter_jit`.
--------------------

ERROR:jax._src.callback:jax.pure_callback failed
Traceback (most recent call last):
  File "/home/mhough/src/dmipy/.venv/lib/python3.12/site-packages/jax/_src/callback.py", line 92, in pure_callback_impl
    return tree_util.tree_map(np.asarray, callback(*args))
                                          ^^^^^^^^^^^^^^^
  File "/home/mhough/src/dmipy/.venv/lib/python3.12/site-packages/jax/_src/callback.py", line 70, in __call__
    return tree_util.tree_leaves(self.callback_func(*args, **kwargs))
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mhough/src/dmipy/.venv/lib/python3.12/site-packages/equinox/_errors.py", line 88, in raises
    raise _EquinoxRuntimeError(
equinox._errors._EquinoxRuntimeError: The maximum number of solver steps was reached. Try increasing `max_steps`.


--------------------
An error occurred during the runtime of your JAX program! Unfortunately you do not appear to be using `equinox.filter_jit` (perhaps you are using `jax.jit` instead?) and so further information about the error cannot be displayed. (Probably you are seeing a very large but uninformative error message right now.) Please wrap your program with `equinox.filter_jit`.
--------------------

=== JAX-POSSUM Demo: PyPulseSeq + BigMac ===
Generating PyPulseSeq sequence...
Converting to JAX-POSSUM GeneralSequence (rasterizing)...
Sequence Duration: 0.0742 s
Time steps: 743
Creating BigMac Phantom...
Phantom created with 1000 spins.
Running Bloch Simulation on GPU (if available)...
Traceback (most recent call last):
  File "/home/mhough/src/dmipy/examples/demo_pypulseq_bigmac.py", line 92, in <module>
    main()
  File "/home/mhough/src/dmipy/examples/demo_pypulseq_bigmac.py", line 81, in main
    signal = simulate_acquisition(phantom, jax_seq, duration=duration)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
jax.errors.JaxRuntimeError: INTERNAL: CpuCallback error calling callback: Traceback (most recent call last):
  File "/home/mhough/src/dmipy/.venv/lib/python3.12/site-packages/jax/_src/callback.py", line 784, in _wrapped_callback
  File "/home/mhough/src/dmipy/.venv/lib/python3.12/site-packages/jax/_src/callback.py", line 223, in _callback
  File "/home/mhough/src/dmipy/.venv/lib/python3.12/site-packages/jax/_src/callback.py", line 95, in pure_callback_impl
  File "/home/mhough/src/dmipy/.venv/lib/python3.12/site-packages/jax/_src/callback.py", line 70, in __call__
  File "/home/mhough/src/dmipy/.venv/lib/python3.12/site-packages/equinox/_errors.py", line 88, in raises
_EquinoxRuntimeError: The maximum number of solver steps was reached. Try increasing `max_steps`.


--------------------
An error occurred during the runtime of your JAX program! Unfortunately you do not appear to be using `equinox.filter_jit` (perhaps you are using `jax.jit` instead?) and so further information about the error cannot be displayed. (Probably you are seeing a very large but uninformative error message right now.) Please wrap your program with `equinox.filter_jit`.
--------------------

--------------------
For simplicity, JAX has removed its internal frames from the traceback of the following exception. Set JAX_TRACEBACK_FILTERING=off to include these.
