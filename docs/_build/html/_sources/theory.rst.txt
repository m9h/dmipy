Theoretical Background
======================

Dmipy-JAX builds upon the "Building Block" philosophy of the original Dmipy framework, enabling the construction of multi-compartment microstructure models.

JAX Acceleration
----------------

The core innovation in Dmipy-JAX is the use of `JAX` for backend computations. This allows for:

1.  **Just-In-Time (JIT) Compilation**: Models are compiled into optimized XLA kernels, significantly speeding up parameter estimation and signal generation.
2.  **Automatic Vectorization**: operations are automatically vectorized over voxels using `jax.vmap`, removing the need for slow Python loops.
3.  **GPU Support**: The same code runs seamlessly on CPUs and NVIDIA GPUs (via CUDA).

Compartment Modeling
--------------------

A microstructure model :math:`E(b, \mathbf{n})` is typically defined as a linear combination of :math:`N` compartments:

.. math::

    E(b, \mathbf{n}) = \sum_{i=1}^{N} f_i E_i(b, \mathbf{n})

where :math:`f_i` is the volume fraction of the :math:`i`-th compartment and :math:`E_i` is its signal attenuation.

Supported Models
----------------

Dmipy-JAX supports a wide range of biophysical models, including:

*   **Stick**: Zero-radius cylinder (intra-axonal water).
*   **Zeppelin**: Cylindrically symmetric tensor.
*   **Sphere**: Restricted diffusion in a sphere.
*   **Tortuous Zeppelin**: Extra-axonal water with tortuosity constraints.
*   **Bingham/Watson Distributions**: Orientation dispersion.

